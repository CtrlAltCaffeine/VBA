import pandas as pd
from collections import OrderedDict

wide_df = pd.read_csv("my_data.csv", delim_whitespace=True)
identifier = wide_df.columns[0]
group_dict = OrderedDict()
for col in wide_df.columns[1:]:
    base = col.split('.')[0]
    if base not in group_dict:
        group_dict[base] = []
    group_dict[base].append(col)
groups = list(group_dict.keys())
group_counts = [len(group_dict[g]) for g in groups]
n_repeats = group_counts[0]
if not all(count == n_repeats for count in group_counts):
    raise ValueError("Not all groups have the same number of columns!")
rows = []
for _, row in wide_df.iterrows():
    id_value = row[identifier]
    for i in range(n_repeats):
        new_row = {identifier: id_value}
        for grp in groups:
            new_row[grp] = row[group_dict[grp][i]]
        rows.append(new_row)
final_df = pd.DataFrame(rows)
final_df = final_df[[identifier] + groups]
print(final_df)

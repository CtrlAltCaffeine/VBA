function chart() {
  var spreadsheet = SpreadsheetApp.getActive();
  
  // Set formulas in columns B, C, and D
  spreadsheet.getRange('B2').setFormula('=COUNTIF(Sheet1!C:C, A2)');
  spreadsheet.getRange('B2:B4').autoFill(spreadsheet.getRange('B2:B4'), SpreadsheetApp.AutoFillSeries.DEFAULT_SERIES);
  
  spreadsheet.getRange('C2').setFormula('=COUNTIF(Sheet1!D:D, A2)');
  spreadsheet.getRange('C2:C4').autoFill(spreadsheet.getRange('C2:C4'), SpreadsheetApp.AutoFillSeries.DEFAULT_SERIES);
  
  spreadsheet.getRange('D2').setFormula('=COUNTIF(Sheet1!E:E, A2)');
  spreadsheet.getRange('D2:D4').autoFill(spreadsheet.getRange('D2:D4'), SpreadsheetApp.AutoFillSeries.DEFAULT_SERIES);
  
  var sheet = spreadsheet.getActiveSheet();
  
  // Create the final chart
  var chart = sheet.newChart()
    .asColumnChart()
    .addRange(spreadsheet.getRange('A1:D4'))
    .setMergeStrategy(Charts.ChartMergeStrategy.MERGE_COLUMNS)
    .setTransposeRowsAndColumns(false)
    .setNumHeaders(1)
    .setHiddenDimensionStrategy(Charts.ChartHiddenDimensionStrategy.IGNORE_BOTH)
    .setOption('applyAggregateData', 0)
    .setOption('bubble.stroke', '#000000')
    .setOption('useFirstColumnAsDomain', true)
    .setOption('isStacked', 'absolute')
    .setOption('title', 'Survey Stacked Chart')
    .setOption('annotations.domain.textStyle.color', '#808080')
    .setOption('textStyle.color', '#000000')
    .setOption('legend.textStyle.color', '#1a1a1a')
    .setOption('titleTextStyle.color', '#757575')
    .setOption('annotations.total.textStyle.color', '#808080')
    .setXAxisTitle('Date')
    .setOption('hAxis.textStyle.color', '#000000')
    .setOption('vAxes.0.textStyle.color', '#000000')
    .setOption('series.0.aggregateFunction', 'sum')
    .setOption('series.0.hasAnnotations', true)
    .setOption('series.0.dataLabel', 'value')
    .setOption('series.0.dataLabelPlacement', 'center')
    .setOption('series.1.aggregateFunction', 'sum')
    .setOption('series.1.hasAnnotations', true)
    .setOption('series.1.dataLabel', 'value')
    .setOption('series.1.dataLabelPlacement', 'center')
    .setOption('series.2.aggregateFunction', 'sum')
    .setOption('series.2.hasAnnotations', true)
    .setOption('series.2.dataLabel', 'value')
    .setOption('series.2.dataLabelPlacement', 'center')
    .setPosition(1, 1, 128, 0)
    .build();
  
  // Insert the final chart
  sheet.insertChart(chart);
}

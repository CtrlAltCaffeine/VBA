import pandas as pd
import dash
from dash import dcc, html
from dash.dependencies import Input, Output
import plotly.express as px

# Load the survey data
df = pd.read_csv('/path/to/your/survey_data.csv')

# Data preprocessing
# Renaming columns for easier reference
df.columns = ['timestamp', 'firm_id_name', 'first_pref_date', 'second_pref_date', 'third_pref_date', 'technical_freeze', 'comments']

# Initialize Dash app
app = dash.Dash(__name__)

# App layout
app.layout = html.Div(children=[
    html.H1(children='Survey Data Analysis Dashboard'),

    html.Div(children='''
        This dashboard visualizes the survey data.
    '''),

    dcc.Graph(id='first-pref-pie'),
    dcc.Graph(id='second-pref-pie'),
    dcc.Graph(id='third-pref-pie')
])

# Callback for first preference pie chart
@app.callback(
    Output('first-pref-pie', 'figure'),
    Input('first-pref-pie', 'id')
)
def update_first_pref_pie(_):
    fig = px.pie(df, names='first_pref_date', title='First Preference Date Distribution')
    return fig

# Callback for second preference pie chart
@app.callback(
    Output('second-pref-pie', 'figure'),
    Input('second-pref-pie', 'id')
)
def update_second_pref_pie(_):
    fig = px.pie(df, names='second_pref_date', title='Second Preference Date Distribution')
    return fig

# Callback for third preference pie chart
@app.callback(
    Output('third-pref-pie', 'figure'),
    Input('third-pref-pie', 'id')
)
def update_third_pref_pie(_):
    fig = px.pie(df, names='third_pref_date', title='Third Preference Date Distribution')
    return fig

if __name__ == '__main__':
    app.run_server(debug=True)

function sendChartEmail() {
  // ID of the Google Sheet containing the chart
  var sheetId = 'YOUR_SHEET_ID';
  var sheetName = 'Sheet3'; // The name of the sheet containing the chart

  // Open the Google Sheet and the specific sheet by name
  var spreadsheet = SpreadsheetApp.openById(sheetId);
  var sheet = spreadsheet.getSheetByName(sheetName);

  if (!sheet) {
    Logger.log('Sheet with name "' + sheetName + '" not found.');
    return;
  }

  var charts = sheet.getCharts();
  if (charts.length === 0) {
    Logger.log('No chart found in the sheet "' + sheetName + '".');
    return;
  }

  // Get the first chart found and its image URL
  var chart = charts[0];
  var chartBlob = chart.getAs('image/png');
  var tempImageFile = DriveApp.createFile(chartBlob);
  var imageUrl = tempImageFile.getDownloadUrl();
  tempImageFile.setTrashed(true); // Clean up the temporary file

  // Email details
  var recipient = 'recipient@example.com';
  var subject = 'Email with Chart';
  var body = '<p>Here is the chart from the Google Sheet:</p>';
  body += '<img src="' + imageUrl + '">';

  // Send the email
  MailApp.sendEmail({
    to: recipient,
    subject: subject,
    htmlBody: body
  });
}

function sendChartEmail() {
  // ID of the Google Sheet containing the chart
  var sheetId = 'YOUR_SHEET_ID';
  var sheetName = 'Sheet3'; // The name of the sheet containing the chart

  // Open the Google Sheet and the specific sheet by name
  var spreadsheet = SpreadsheetApp.openById(sheetId);
  var sheet = spreadsheet.getSheetByName(sheetName);

  if (!sheet) {
    Logger.log('Sheet with name "' + sheetName + '" not found.');
    return;
  }

  var charts = sheet.getCharts();
  if (charts.length === 0) {
    Logger.log('No chart found in the sheet "' + sheetName + '".');
    return;
  }

  // Get the first chart found and its image as a blob
  var chart = charts[0];
  var chartBlob = chart.getAs('image/png');

  // Create a temporary image file in Google Drive and make it public
  var tempImageFile = DriveApp.createFile(chartBlob).setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);
  var imageUrl = tempImageFile.getDownloadUrl();

  // Email details
  var recipient = 'recipient@example.com';
  var subject = 'Email with Chart';
  var body = '<p>Here is the chart from the Google Sheet:</p>';
  body += '<img src="' + imageUrl + '" alt="Chart">';

  // Send the email
  MailApp.sendEmail({
    to: recipient,
    subject: subject,
    htmlBody: body
  });

  // Optionally, delete the temporary file after a delay (e.g., 5 minutes)
  ScriptApp.newTrigger('deleteTempFile')
           .timeBased()
           .after(5 * 60 * 1000) // 5 minutes
           .create();
}

function deleteTempFile() {
  var files = DriveApp.getFilesByName('Chart.png');
  while (files.hasNext()) {
    var file = files.next();
    file.setTrashed(true);
  }
}

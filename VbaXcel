function downloadAttachmentsFromSendersWithSubject() {
  var senders = ["rakesh@example.com", "john@example.com", "mary@example.com"];
  var subjectKeyword = "test";
  var threads = [];

  for (var i = 0; i < senders.length; i++) {
    var sender = senders[i];
    var senderThreads = GmailApp.search('from:' + sender + ' is:unread subject:' + subjectKeyword);
    threads = threads.concat(senderThreads);
  }

  for (var i = 0; i < threads.length; i++) {
    var messages = threads[i].getMessages();

    for (var j = 0; j < messages.length; j++) {
      var attachments = messages[j].getAttachments();

      if (attachments.length > 0) {
        for (var k = 0; k < attachments.length; k++) {
          var attachment = attachments[k];
          var attachmentName = attachment.getName();
          var attachmentData = attachment.copyBlob();

          var contentType = attachment.getContentType();
          var fileExtension = getExtensionFromContentType(contentType);
          var fileName = attachmentName + fileExtension;

          var blob = Utilities.newBlob(attachmentData.getBytes(), contentType, fileName);
          DriveApp.createFile(blob);
        }
      }

      messages[j].markRead();
    }
  }
}

function getExtensionFromContentType(contentType) {
  var mimeToExtMap = {
    "application/pdf": ".pdf",
    "image/jpeg": ".jpg",
    "image/png": ".png",
    // Add more mime types and corresponding extensions as needed
  };

  return mimeToExtMap[contentType] || ".dat"; // Default extension if not found in the map
}

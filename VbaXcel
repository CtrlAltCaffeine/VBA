function downloadAttachmentsFromSendersWithSubject() {
  var senders = ["rakesh@example.com", "john@example.com", "mary@example.com"];
  var subjectKeyword = "test";
  var threads = [];

  for (var i = 0; i < senders.length; i++) {
    var sender = senders[i];
    var senderThreads = GmailApp.search('from:' + sender + ' is:unread subject:' + subjectKeyword);
    threads = threads.concat(senderThreads);
  }

  for (var i = 0; i < threads.length; i++) {
    var messages = threads[i].getMessages();

    for (var j = 0; j < messages.length; j++) {
      var attachments = messages[j].getAttachments();

      if (attachments.length > 0) {
        for (var k = 0; k < attachments.length; k++) {
          var attachment = attachments[k];
          var attachmentName = attachment.getName();
          var attachmentData = attachment.copyBlob();

          var blob = Utilities.newBlob(attachmentData.getBytes(), attachmentData.getContentType(), attachmentName);
          DriveApp.createFile(blob);
        }
      }

      messages[j].markRead();
    }
  }
}

function extractUrlsFromBody(body) {
  var urls = [];
  var regex = /https?:\/\/[^\s]+/g;
  var matches = body.match(regex);

  if (matches) {
    urls = matches.filter(function (url) {
      return true;
    });
  }

  return urls;
}

function downloadFileFromUrl(url) {
  try {
    var options = {
      followRedirects: true,
      headers: {
        "User-Agent": "Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)"
      }
    };

    var response = UrlFetchApp.fetch(url, options);

    if (response.getResponseCode() === 200) {
      var fileBlob = response.getBlob();

      var fileName = getFileNameFromHeaders(response);

      if (fileName === null) {
        fileName = "downloaded_file.pdf";
      }

      var folder = DriveApp.getRootFolder();
      folder.createFile(fileBlob.setName(fileName));
    } else {
      Logger.log("Failed to download file from URL: " + url + " - Response code: " + response.getResponseCode());
    }
  } catch (error) {
    Logger.log("Error while downloading file from URL: " + url + " - " + error.toString());
  }
}

function getFileNameFromHeaders(response) {
  var headers = response.getAllHeaders();
  var contentDisposition = headers["Content-Disposition"];

  if (contentDisposition && contentDisposition.indexOf("filename=") !== -1) {
    var startIndex = contentDisposition.indexOf("filename=") + 9;
    var endIndex = contentDisposition.indexOf(";", startIndex);

    if (endIndex === -1) {
      endIndex = contentDisposition.length;
    }

    return contentDisposition.substring(startIndex, endIndex);
  }

  return null;
}
